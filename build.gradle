plugins {
    id 'java'
}

sourceCompatibility = JavaVersion.toVersion(project.java_version)
targetCompatibility = JavaVersion.toVersion(project.java_version)

archivesBaseName = project.plugin_id
group = "com.kale_ko"
version = project.plugin_version

tasks.withType(JavaCompile).configureEach {
    sourceCompatibility = JavaVersion.toVersion(project.java_version)
    targetCompatibility = JavaVersion.toVersion(project.java_version)

    options.encoding = "UTF-8"
}

def mainProjects = [":Shared", ":Spigot", ":Bungee"]
tasks.register("buildAll", Jar) {
    dependsOn mainProjects.collect{ it + ":build" }

    duplicatesStrategy = "exclude"

    destinationDirectory = file("\\")
    from files(mainProjects.collect { project(it).sourceSets.main.output })
    from files(mainProjects.collect { project(it).configurations.implementation.collect { it.isDirectory() ? it : zipTree(it) } })
}